<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î∞∞ÎãπÏú® ÎπÑÏ§ë Î∂ÑÏÑùÍ∏∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .input-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
            color: #555;
            font-size: 1.1em;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 1em;
            font-family: 'Courier New', monospace;
            resize: vertical;
            transition: all 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .hint {
            font-size: 0.9em;
            color: #666;
            margin-top: 8px;
            font-style: italic;
        }

        button {
            width: 100%;
            padding: 18px;
            background: #5865F2;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 20px;
        }

        button:hover {
            background: #4752C4;
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(88, 101, 242, 0.4);
        }

        .results-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 25px;
            margin-top: 30px;
        }

        .result-section {
            background: #E8EBF7;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
        }

        .section-title {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.3em;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .cards-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }
        
        }

        .dividend-card {
            background: #F5F7FB;
            padding: 20px 15px;
            border-radius: 12px;
            text-align: center;
        }

        .card-label {
            font-size: 0.85em;
            color: #6B7280;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .number-circles {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin: 15px 0;
        }

        .circle {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.15em;
            border: 2.5px solid;
        }

        .circle.blue {
            background: #DBEAFE;
            color: #2563EB;
            border-color: #2563EB;
        }

        .circle.purple {
            background: #E9D5FF;
            color: #9333EA;
            border-color: #9333EA;
        }

        .circle.green {
            background: #D1FAE5;
            color: #059669;
            border-color: #059669;
        }

        .dividend-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #1F2937;
        }

        .ratio-box {
            background: #FEF3C7;
            padding: 20px;
            border-radius: 12px;
        }

        .ratio-label {
            font-size: 0.9em;
            color: #92400E;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .ratio-value {
            font-size: 2.2em;
            font-weight: bold;
            color: #F59E0B;
            margin-bottom: 8px;
        }

        .ratio-formula {
            font-size: 0.9em;
            color: #78716C;
        }

        .proportion-cards {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        }

        .proportion-card {
            background: #F5F7FB;
            padding: 20px 15px;
            border-radius: 12px;
            text-align: center;
        }

        .proportion-label {
            font-size: 0.85em;
            color: #6B7280;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .proportion-circles {
            display: flex;
            justify-content: center;
            gap: 5px;
            margin: 15px 0;
        }

        .proportion-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #059669;
            margin-top: 10px;
        }

        .error {
            background: #FEE2E2;
            border: 2px solid #FCA5A5;
            color: #991B1B;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }

        /* ÎπàÎèÑ Î∂ÑÏÑù ÌÖåÏù¥Î∏î Ïä§ÌÉÄÏùº */
        .frequency-section {
            margin-top: 30px;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        }

        .frequency-title {
            font-size: 1.5em;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .frequency-table {
            width: 100%;
            min-width: 600px;
            border-collapse: collapse;
            margin-top: 20px;
            font-size: 0.95em;
            table-layout: fixed;
        }

        .frequency-table th {
            background: #F3F4F6;
            padding: 12px 8px;
            text-align: center;
            font-weight: bold;
            color: #374151;
            border: 1px solid #E5E7EB;
            width: 10%;
        }

        .frequency-table td {
            padding: 10px 8px;
            text-align: center;
            border: 1px solid #E5E7EB;
            font-weight: 600;
            width: 10%;
        }

        .frequency-table .number-col {
            background: #FEF3C7;
            font-weight: bold;
            color: #333;
        }

        .frequency-table .number-circle {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #FCD34D;
            border: 2px solid #F59E0B;
            font-size: 0.9em;
        }
        
        }

        .freq-high {
            background: #FCA5A5 !important;
            color: #333;
        }

        .freq-medium {
            background: #FED7D7 !important;
            color: #333;
        }

        .freq-low {
            background: #BFDBFE !important;
            color: #333;
        }

        .freq-zero {
            background: #DBEAFE !important;
            color: #333;
        }

            h1 { font-size: 1.5em; }
            .input-section { padding: 20px; }
            textarea { min-height: 150px; font-size: 0.9em; }
            button { padding: 15px; font-size: 1.1em; }
            
            .cards-container, .proportion-cards {
                grid-template-columns: repeat(3, 1fr);
                gap: 6px;
            }
            .dividend-card, .proportion-card { padding: 10px 5px; }
            .card-label, .proportion-label { font-size: 0.7em; }
            .circle { width: 30px; height: 30px; font-size: 0.85em; }
            .dividend-value, .proportion-value { font-size: 1.2em; }
            .ratio-box { padding: 12px; }
            .ratio-value { font-size: 1.6em; }
            .ratio-formula { font-size: 0.8em; }
            
            .frequency-section { 
                padding: 10px; 
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            .frequency-title { font-size: 1em; margin-bottom: 10px; }
            .frequency-table { 
                font-size: 0.55em;
                min-width: auto;
                width: 100%;
            }
            .frequency-table th, .frequency-table td { 
                padding: 3px 1px;
                font-size: 0.9em;
            }
            .frequency-table .number-circle { 
                width: 18px;
                height: 18px;
                font-size: 0.65em;
                border-width: 1px;
            }
        }
        @media (max-width: 768px) {
            .container { padding: 15px; }
            h1 { font-size: 1.5em; }
            .input-section { padding: 20px; }
            textarea { min-height: 150px; font-size: 0.9em; }
            button { padding: 15px; font-size: 1.1em; }
            
            .cards-container, .proportion-cards {
                grid-template-columns: repeat(3, 1fr);
                gap: 6px;
            }
            .dividend-card, .proportion-card { padding: 10px 5px; }
            .card-label, .proportion-label { font-size: 0.7em; }
            .circle { width: 30px; height: 30px; font-size: 0.85em; }
            .dividend-value, .proportion-value { font-size: 1.2em; }
            .ratio-box { padding: 12px; }
            .ratio-value { font-size: 1.6em; }
            .ratio-formula { font-size: 0.8em; }
            
            .frequency-section { 
                padding: 10px; 
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
            .frequency-title { font-size: 1em; margin-bottom: 10px; }
            .frequency-table { 
                font-size: 0.55em;
                width: 100%;
            }
            .frequency-table th, .frequency-table td { 
                padding: 3px 1px;
                font-size: 0.9em;
            }
            .frequency-table .number-circle { 
                width: 18px;
                height: 18px;
                font-size: 0.65em;
                border-width: 1px;
            }
        }
    </style>
            <label>Î∞∞ÎãπÏú® Îç∞Ïù¥ÌÑ∞ ÏûÖÎ†•</label>
            <textarea id="dataInput" placeholder="ÏòàÏãú:
‚ë¢‚ëß	2.6	‚ë¢‚ë§	5.0	‚ë¢‚ë¶	9.5
‚ë¢‚ë£	11.1	‚ëß‚ë¢	13.2	‚ë¢‚ë®	16.9
‚ë§‚ë¢	18.2	‚ë¢‚ë†	20.1	‚ë¢‚ë°	21.4"></textarea>
            <div class="hint">* Í∞Å Ï§ÑÏóê "Î≤àÌò∏Ïåç Î∞∞ÎãπÏú®" ÌòïÏãùÏúºÎ°ú ÏûÖÎ†•ÌïòÏÑ∏Ïöî. ÌÉ≠Ïù¥ÎÇò Í≥µÎ∞±ÏúºÎ°ú Íµ¨Î∂ÑÎê©ÎãàÎã§.</div>
            <button onclick="analyze()">Î∂ÑÏÑùÌïòÍ∏∞</button>
        </div>

        <div id="results"></div>
        <div id="frequency-analysis"></div>
    </div>

    <script>
        function parseData(input) {
            const lines = input.trim().split('\n');
            const data = [];
            
            for (const line of lines) {
                const parts = line.trim().split(/\s+/);
                
                for (let i = 0; i < parts.length; i += 2) {
                    if (i + 1 < parts.length) {
                        const pair = parts[i];
                        const dividend = parseFloat(parts[i + 1]);
                        
                        if (!isNaN(dividend) && pair) {
                            data.push({
                                pair: pair,
                                dividend: dividend
                            });
                        }
                    }
                }
            }
            
            return data;
        }

        function extractNumbers(pair) {
            // ÎèôÍ∑∏ÎùºÎØ∏ Ïà´ÏûêÎ•º Ï∂îÏ∂ú (‚ë†-‚ë≥)
            const matches = pair.match(/[‚ë†-‚ë≥]/g) || [];
            return matches.map(circle => {
                const code = circle.charCodeAt(0);
                if (code >= 0x2460 && code <= 0x2468) return code - 0x245F; // ‚ë†-‚ë®
                if (code === 0x2469) return 10; // ‚ë©
                if (code >= 0x246A && code <= 0x2473) return code - 0x246A + 11; // ‚ë™-‚ë≥
                return 0;
            });
        }

        function findCrossPoint(data, pair1, pair2) {
            const nums1 = extractNumbers(pair1);
            const nums2 = extractNumbers(pair2);
            
            // Í≥µÌÜµÎêòÏßÄ ÏïäÏùÄ Ïà´Ïûê Ï∞æÍ∏∞
            const unique1 = nums1.filter(n => !nums2.includes(n));
            const unique2 = nums2.filter(n => !nums1.includes(n));
            
            // ÍµêÏ∞®Ï†ê Ï°∞Ìï© ÏÉùÏÑ±
            const crossNumbers = [...unique1, ...unique2].sort((a, b) => a - b);
            
            // Îç∞Ïù¥ÌÑ∞ÏóêÏÑú ÍµêÏ∞®Ï†ê Ï∞æÍ∏∞
            for (const item of data) {
                const itemNums = extractNumbers(item.pair).sort((a, b) => a - b);
                if (JSON.stringify(itemNums) === JSON.stringify(crossNumbers)) {
                    return item;
                }
            }
            
            return null;
        }

        function analyze() {
            const input = document.getElementById('dataInput').value.trim();
            const resultsDiv = document.getElementById('results');
            
            if (!input) {
                resultsDiv.innerHTML = '<div class="error">Îç∞Ïù¥ÌÑ∞Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.</div>';
                return;
            }

            const data = parseData(input);
            
            if (data.length < 6) {
                resultsDiv.innerHTML = '<div class="error">ÏµúÏÜå 6Í∞ú Ïù¥ÏÉÅÏùò Îç∞Ïù¥ÌÑ∞Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî.</div>';
                return;
            }

            // 1&2: ÏµúÏ†ÄÎ∞∞Îãπ Î∂ÑÏÑù
            const sorted = [...data].sort((a, b) => a.dividend - b.dividend);
            const lowest1 = sorted[0];
            const lowest2 = sorted[1];
            const crossPoint = findCrossPoint(data, lowest1.pair, lowest2.pair);
            
            let analysis12 = null;
            if (crossPoint) {
                const ratio = (lowest1.dividend * lowest2.dividend) / crossPoint.dividend;
                analysis12 = {
                    lowest1,
                    lowest2,
                    crossPoint,
                    ratio
                };
            }

            // 2&3: 3Í∞ú ÏßùÏùò ÎπÑÏ§ë
            let analysis23 = null;
            if (analysis12) {
                const sum = lowest1.dividend + lowest2.dividend + crossPoint.dividend;
                analysis23 = {
                    items: [
                        { ...lowest1, proportion: (lowest1.dividend / sum) * 100, label: '1Î≤àÏßù' },
                        { ...lowest2, proportion: (lowest2.dividend / sum) * 100, label: '2Î≤àÏßù' },
                        { ...crossPoint, proportion: (crossPoint.dividend / sum) * 100, label: '3Î≤àÏßù' }
                    ],
                    sum
                };
            }

            // 3&4: Ï≤òÏùå 6Í∞ú Ï§ë ÏÉÅÏúÑ 3Í∞ú
            const first6 = data.slice(0, 6);
            const sorted6 = [...first6].sort((a, b) => a.dividend - b.dividend);
            const top3 = sorted6.slice(0, 3);
            const sum6 = first6.reduce((acc, item) => acc + item.dividend, 0);
            
            const analysis34 = {
                items: top3.map((item, index) => ({
                    ...item,
                    proportion: (item.dividend / sum6) * 100,
                    rank: index + 1,
                    originalIndex: first6.indexOf(item) + 1
                })),
                sum: sum6
            };

            displayResults(analysis12, analysis23, analysis34);
            
            // ÎπàÎèÑ Î∂ÑÏÑù Ï∂îÍ∞Ä
            displayFrequencyAnalysis(data);
        }

        function displayResults(analysis12, analysis23, analysis34) {
            const resultsDiv = document.getElementById('results');
            
            let html = '<div class="results-grid">';
            
            // 1&2: ÏµúÏ†ÄÎ∞∞Îãπ
            if (analysis12) {
                html += `
                    <div class="result-section">
                        <div class="section-title">
                            üìä ÏµúÏ†ÄÎ∞∞Îãπ (1 & 2)
                        </div>
                        
                        <div class="cards-container">
                            <div class="dividend-card">
                                <div class="card-label">ÏµúÏ†ÄÎ∞∞Îãπ1</div>
                                <div class="number-circles">
                                    ${generateCircles(analysis12.lowest1.pair, 'blue')}
                                </div>
                                <div class="dividend-value">${analysis12.lowest1.dividend}</div>
                            </div>
                            
                            <div class="dividend-card">
                                <div class="card-label">ÏµúÏ†ÄÎ∞∞Îãπ2</div>
                                <div class="number-circles">
                                    ${generateCircles(analysis12.lowest2.pair, 'purple')}
                                </div>
                                <div class="dividend-value">${analysis12.lowest2.dividend}</div>
                            </div>
                            
                            <div class="dividend-card">
                                <div class="card-label">ÍµêÏ∞®Ï†ê</div>
                                <div class="number-circles">
                                    ${generateCircles(analysis12.crossPoint.pair, 'green')}
                                </div>
                                <div class="dividend-value">${analysis12.crossPoint.dividend}</div>
                            </div>
                        </div>
                        
                        <div class="ratio-box">
                            <div class="ratio-label">ÎπÑÏú®</div>
                            <div class="ratio-value">${analysis12.ratio.toFixed(6)}</div>
                            <div class="ratio-formula">= (${analysis12.lowest1.dividend} √ó ${analysis12.lowest2.dividend}) / ${analysis12.crossPoint.dividend}</div>
                        </div>
                    </div>
                `;
            }

            // 2&3: 3Í∞ú Ïßù ÎπÑÏ§ë
            if (analysis23) {
                html += `
                    <div class="result-section">
                        <div class="section-title">
                            üìà ÏÉÅÏúÑ 3Í∞ú Ïßù ÎπÑÏ§ë (2 & 3)
                        </div>
                        <div class="proportion-cards">
                `;
                
                analysis23.items.forEach(item => {
                    html += `
                        <div class="proportion-card">
                            <div class="proportion-label">${item.label}</div>
                            <div class="proportion-circles">
                                ${generateCircles(item.pair, 'blue')}
                            </div>
                            <div class="dividend-value">${item.dividend}</div>
                            <div class="proportion-value">${item.proportion.toFixed(2)}%</div>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            }

            // 3&4: Ï≤òÏùå 6Í∞ú Ï§ë ÏÉÅÏúÑ 3Í∞ú
            html += `
                <div class="result-section">
                    <div class="section-title">
                        üéØ Ï≤òÏùå 6Í∞ú Ï§ë ÏÉÅÏúÑ 3Í∞ú (3 & 4)
                    </div>
                    <div class="proportion-cards">
            `;
            
            analysis34.items.forEach(item => {
                html += `
                    <div class="proportion-card">
                        <div class="proportion-label">${item.rank}ÏúÑ (${item.originalIndex}Î≤àÏß∏)</div>
                        <div class="proportion-circles">
                            ${generateCircles(item.pair, 'green')}
                        </div>
                        <div class="dividend-value">${item.dividend}</div>
                        <div class="proportion-value">${item.proportion.toFixed(2)}%</div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                </div>
            `;
            
            html += '</div>';
            
            resultsDiv.innerHTML = html;
        }

        function generateCircles(pair, colorClass) {
            const circles = pair.match(/[‚ë†-‚ëØ]/g) || [];
            return circles.map(circle => `<div class="circle ${colorClass}">${circle}</div>`).join('');
        }

        function displayFrequencyAnalysis(data) {
            const frequencyDiv = document.getElementById('frequency-analysis');
            
            // Í∞Å Ï§ÑÏùÄ 3Í∞ú Ïßù = Ìïú Ï§Ñ
            const linesPerPage = 10;
            const pairsPerLine = 3;
            const totalLines = Math.ceil(data.length / pairsPerLine);
            const totalPages = Math.ceil(totalLines / linesPerPage);
            
            let html = '';
            
            // Ï†ÑÏ≤¥ ÎàÑÏ†ÅÏùÑ ÏúÑÌïú Î≥ÄÏàò
            let cumulativeFreq = {};
            
            for (let page = 0; page < totalPages; page++) {
                const startLine = page * linesPerPage + 1;
                const endLine = Math.min((page + 1) * linesPerPage, totalLines);
                const startIdx = page * linesPerPage * pairsPerLine;
                const endIdx = Math.min(startIdx + linesPerPage * pairsPerLine, data.length);
                
                const pageData = data.slice(startIdx, endIdx);
                
                // Ïù¥ ÌéòÏù¥ÏßÄÎ•º 3Îì±Î∂Ñ
                const third = Math.ceil(pageData.length / 3);
                const firstPart = pageData.slice(0, third);
                const middlePart = pageData.slice(third, third * 2);
                const lastPart = pageData.slice(third * 2);
                
                // Í∞Å Î∂ÄÎ∂ÑÏùò ÎπàÎèÑ Í≥ÑÏÇ∞
                const firstFreq = countFrequency(firstPart);
                const middleFreq = countFrequency(middlePart);
                const lastFreq = countFrequency(lastPart);
                const totalFreq = countFrequency(pageData);
                
                // ÎàÑÏ†Å ÎπàÎèÑ ÏóÖÎç∞Ïù¥Ìä∏
                for (const [num, count] of Object.entries(totalFreq)) {
                    cumulativeFreq[num] = (cumulativeFreq[num] || 0) + count;
                }
                
                // Î™®Îì† Îì±Ïû•ÌïòÎäî Ïà´Ïûê Ï∞æÍ∏∞
                const allNumbers = new Set([
                    ...Object.keys(firstFreq),
                    ...Object.keys(middleFreq),
                    ...Object.keys(lastFreq),
                    ...Object.keys(totalFreq),
                    ...Object.keys(cumulativeFreq)
                ]);
                
                const sortedNumbers = Array.from(allNumbers).map(n => parseInt(n)).sort((a, b) => a - b);
                
                // Í∞Å Ïó¥Ïùò ÏµúÎåÄ/ÏµúÏÜå Í∞í Í≥ÑÏÇ∞ (ÏÉâÏÉÅ Í≤∞Ï†ïÏö©)
                const firstValues = sortedNumbers.map(n => firstFreq[n] || 0);
                const middleValues = sortedNumbers.map(n => middleFreq[n] || 0);
                const lastValues = sortedNumbers.map(n => lastFreq[n] || 0);
                const totalValues = sortedNumbers.map(n => totalFreq[n] || 0);
                const cumulValues = sortedNumbers.map(n => cumulativeFreq[n] || 0);
                
                const firstMax = Math.max(...firstValues);
                const firstMin = Math.min(...firstValues);
                const middleMax = Math.max(...middleValues);
                const middleMin = Math.min(...middleValues);
                const lastMax = Math.max(...lastValues);
                const lastMin = Math.min(...lastValues);
                const totalMax = Math.max(...totalValues);
                const totalMin = Math.min(...totalValues);
                const cumulMax = Math.max(...cumulValues);
                const cumulMin = Math.min(...cumulValues);
                
                html += `
                    <div class="frequency-section">
                        <div class="frequency-title">${startLine}-${endLine}Ï§Ñ Î∂ÑÏÑù</div>
                        <table class="frequency-table">
                            <thead>
                                <tr>
                                    <th>Ï≤´Î∂ÄÎ∂Ñ</th>
                                    <th></th>
                                    <th>Ï§ëÍ∞Ñ</th>
                                    <th></th>
                                    <th>ÏïÑÎû´Î∂ÄÎ∂Ñ</th>
                                    <th></th>
                                    <th>Ï†ÑÏ≤¥</th>
                                    <th></th>
                                    <th>ÎàÑÏ†Å</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                sortedNumbers.forEach(num => {
                    const circleChar = numberToCircle(num);
                    const f1 = firstFreq[num] || 0;
                    const f2 = middleFreq[num] || 0;
                    const f3 = lastFreq[num] || 0;
                    const ft = totalFreq[num] || 0;
                    const fc = cumulativeFreq[num] || 0;
                    
                    // Í∞Å Ïó¥Ïùò ÏµúÎåÄ/ÏµúÏÜå Í∏∞Ï§ÄÏúºÎ°ú ÏÉâÏÉÅ Í≤∞Ï†ï
                    const s1 = getGradientStyle(f1, firstMin, firstMax);
                    const s2 = getGradientStyle(f2, middleMin, middleMax);
                    const s3 = getGradientStyle(f3, lastMin, lastMax);
                    const st = getGradientStyle(ft, totalMin, totalMax);
                    const sc = getGradientStyle(fc, cumulMin, cumulMax);
                    
                    html += `
                        <tr>
                            <td class="number-col"><span class="number-circle">${circleChar}</span></td>
                            <td ${s1}>${f1}</td>
                            <td class="number-col"><span class="number-circle">${circleChar}</span></td>
                            <td ${s2}>${f2}</td>
                            <td class="number-col"><span class="number-circle">${circleChar}</span></td>
                            <td ${s3}>${f3}</td>
                            <td class="number-col"><span class="number-circle">${circleChar}</span></td>
                            <td ${st}>${ft}</td>
                            <td class="number-col"><span class="number-circle">${circleChar}</span></td>
                            <td ${sc}>${fc}</td>
                        </tr>
                    `;
                });
                
                html += `
                            </tbody>
                        </table>
                    </div>
                `;
            }
            
            frequencyDiv.innerHTML = html;
        }

        function countFrequency(dataSegment) {
            const freq = {};
            
            dataSegment.forEach(item => {
                const numbers = extractNumbers(item.pair);
                numbers.forEach(num => {
                    freq[num] = (freq[num] || 0) + 1;
                });
            });
            
            return freq;
        }

        function getGradientStyle(value, min, max) {
            // 0Ïù∏ Í≤ΩÏö∞ ÌååÎûÄÏÉâ
            if (value === 0) {
                return 'style="background-color: #BFDBFE !important; color: #333;"';
            }
            
            // Í∞íÏù¥ ÌïòÎÇòÎßå ÏûàÎäî Í≤ΩÏö∞
            if (max === min) {
                return 'style="background-color: #FFFFFF !important; color: #333;"';
            }
            
            // 0~1 ÏÇ¨Ïù¥Ïùò ÎπÑÏú® Í≥ÑÏÇ∞ (min=0, max=1)
            const ratio = (value - min) / (max - min);
            const color = getGradientColor(ratio);
            
            return `style="background-color: ${color} !important; color: #333;"`;
        }

        function getGradientColor(ratio) {
            // ÌååÎûÄÏÉâ(ÎÇÆÏùå) -> Ìù∞ÏÉâ(Ï§ëÍ∞Ñ) -> Îπ®Í∞ÑÏÉâ(ÎÜíÏùå)
            // Îçî ÏÑ†Î™ÖÌïú ÏÉâÏÉÅÏúºÎ°ú Î≥ÄÍ≤Ω
            if (ratio <= 0.5) {
                // ÏßÑÌïú ÌååÎûÄÏÉâ -> Ìù∞ÏÉâ
                const t = ratio * 2; // 0~1
                const r = Math.round(100 + (255 - 100) * t);
                const g = Math.round(150 + (255 - 150) * t);
                const b = Math.round(255);
                return `rgb(${r}, ${g}, ${b})`;
            } else {
                // Ìù∞ÏÉâ -> ÏßÑÌïú Îπ®Í∞ÑÏÉâ
                const t = (ratio - 0.5) * 2; // 0~1
                const r = 255;
                const g = Math.round(255 - (255 - 100) * t);
                const b = Math.round(255 - (255 - 100) * t);
                return `rgb(${r}, ${g}, ${b})`;
            }
        }

        function numberToCircle(num) {
            if (num >= 1 && num <= 9) {
                return String.fromCharCode(0x245F + num);
            } else if (num === 10) {
                return '‚ë©';
            } else if (num >= 11 && num <= 20) {
                return String.fromCharCode(0x246A + num - 11);
            }
            return num.toString();
        }
    </script>
</body>
</html>
